# 抖音自动续火花插件 - 错误报告功能说明

## 新增功能概述

本版本在原有的自动续火花功能基础上，新增了全面的错误报告和调试功能，解决了原版本"无报错能力"的问题。

## 🔧 新增的错误报告功能

### 1. 多级日志系统
- **DEBUG**: 调试信息，详细的执行步骤
- **INFO**: 一般信息，执行状态和进度
- **WARN**: 警告信息，非致命性问题
- **ERROR**: 错误信息，执行失败的详细原因

### 2. 可视化错误面板
- 右上角新增"🐛 查看日志"按钮
- 实时显示最近20条日志记录
- 支持清空日志历史
- 错误按级别用不同颜色区分

### 3. 智能错误通知
- 执行失败时自动弹出错误通知
- 显示具体的失败原因和建议
- 执行完成后显示汇总统计
- 点击通知可查看详细日志

### 4. 配置验证
- 启动时自动检查配置参数
- 验证联系人列表、消息内容等设置
- 配置错误时给出具体修复建议

### 5. 详细的执行追踪
- 每个步骤都有详细的日志记录
- 失败时记录具体的DOM元素查找过程
- 记录重试次数和失败原因
- 支持执行结果统计和分析

## 🎯 使用说明

### 基本使用
1. 安装脚本后，页面右上角会出现两个按钮：
   - **"手动续火花"**: 立即执行续火花任务
   - **"🐛 查看日志"**: 打开错误日志面板

### 查看错误日志
1. 点击"🐛 查看日志"按钮
2. 在弹出的面板中可以看到：
   - 最近的20条执行日志
   - 不同级别的日志用不同颜色区分
   - 每条日志包含时间戳和详细信息
3. 可以点击"清空"按钮清除历史日志

### 错误诊断
当执行失败时，系统会：
1. 自动弹出错误通知，显示失败原因
2. 在控制台输出详细的错误信息
3. 在日志面板中记录完整的执行过程
4. 提供具体的修复建议

## 🛠️ 常见错误及解决方案

### 1. "未找到私信按钮"
**原因**: 页面未完全加载或页面结构发生变化
**解决**: 
- 等待页面完全加载后再执行
- 检查是否在抖音首页
- 查看日志中的详细查找过程

### 2. "未找到联系人"
**原因**: 联系人昵称配置错误或联系人不在私信列表中
**解决**:
- 检查CONTACTS配置中的昵称是否准确
- 确认联系人在私信列表中
- 查看日志中的联系人查找详情

### 3. "未找到消息输入框"
**原因**: 没有成功进入聊天界面
**解决**:
- 确认联系人点击成功
- 等待聊天界面完全加载
- 查看日志中的输入框查找过程

### 4. "配置验证失败"
**原因**: 脚本配置参数不正确
**解决**:
- 检查CONTACTS是否为有效数组
- 检查MESSAGE是否为有效字符串
- 检查时间格式是否为HH:MM

## 📊 执行结果统计

执行完成后会显示详细统计：
- **总计**: 处理的联系人总数
- **成功**: 成功发送消息的数量
- **失败**: 发送失败的数量
- **失败详情**: 具体哪些联系人失败及原因

## 🔍 调试模式

如需更详细的调试信息：
1. 打开浏览器开发者工具(F12)
2. 查看Console标签页
3. 所有日志都会在控制台输出，包含完整的错误堆栈

## 📝 配置建议

为了获得最佳的错误报告体验：

1. **设置合理的等待时间**:
   ```javascript
   const WAIT = 2000; // 建议不少于2秒
   ```

2. **准确配置联系人昵称**:
   ```javascript
   const CONTACTS = ["张三", "李四"]; // 使用完全匹配的昵称
   ```

3. **启用调试模式**(可选):
   ```javascript
   // 在errorReporter初始化后添加
   errorReporter.logLevel = 'DEBUG';
   ```

## 🚀 版本更新内容

### v2.0 新增功能
- ✅ 完整的错误报告系统
- ✅ 可视化日志面板
- ✅ 智能错误通知
- ✅ 配置验证机制
- ✅ 执行结果统计
- ✅ 详细的调试信息
- ✅ 错误恢复机制
- ✅ 用户友好的错误提示

这个增强版本彻底解决了原版本"无报错能力"的问题，为用户提供了全面的错误诊断和调试工具。
